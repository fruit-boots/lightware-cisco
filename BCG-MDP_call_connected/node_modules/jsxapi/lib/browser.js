"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var ws_1 = __importDefault(require("./backend/ws"));
var connect_1 = __importDefault(require("./connect"));
var ws_2 = __importDefault(require("./transport/ws"));
var xapi_1 = require("./xapi");
exports.XAPI = xapi_1.default;
function initBackend(opts) {
    var protocol = opts.protocol;
    switch (protocol) {
        case '':
        case 'ws:':
        case 'wss:': {
            var createWebSocket = function (url, auth) {
                return new WebSocket(url, auth);
            };
            var transport = ws_2.default(createWebSocket, opts);
            return new ws_1.default(transport);
        }
        default:
            throw new Error("Invalid protocol: " + protocol);
    }
}
exports.connect = connect_1.default(initBackend, { protocol: 'wss:' });
